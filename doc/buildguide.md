# Build Guide

![cocot_micro_main00](/images/main_00.jpg)

cocot microのビルドガイドです。

cocot microは自作キーボードのエッセンスからデザインされた自作トラックボールキットです。トラックボールマウスとしてはもちろん、ポインティングデバイスが付属したマクロパッドとして活用することも可能です。

## 部品
### キット付属品

|名前|数|備考|
|---|---|---|
|PCB|1枚||
|マウスセンサー（PMW3360）|1||
|リングエンコーダ（PER601）|1||
|M3ねじ 10mm|3||
|M3ナット|3|
|M2ねじ 8mm|2|
|M2ナット|2||
|M2ねじ 3mm|8|
|M2スペーサー 4mm|4||
|ゴム脚|4||
|3Dプリントボールベース|1||
|3Dプリントボールカバー|1||
|3Dプリントキーキャップ|8|オプション|
|3Dプリントケース|1|オプション|


### キット以外に必要なもの

|名前|数|備考|
|---|---|---|
|MX互換キースイッチ|8||
|34mmボール|1||
|USB-TypeCケーブル|1||


## 組み立て
### 部品確認

  まずはキット付属品に記載されたパーツが揃っているか確認ください。  
  その他上述の「キット以外に必要なもの」を揃えた上で組み立てに取り掛かってください。

  - タブ付きPCBの場合にはタブを割って切り離し、切断面を軽くヤスリがけしてください。
  - 3Dプリントケースを用いない場合、PCBの側面を油性マジックなどで黒く塗ると見栄えが良くなります。


### マウスセンサー

  マウスセンサー（PMW3360）を基板裏面から写真の向きに設置し、表面からはんだ付けを行います。シルクの●印と基板の●　印の位置が合うように注意してください。  
  ![cocot_micro_bg_01_1](/images/bg_01_1.jpg)

  センサーの脚がしっかり奥まで入った状態で、浮かないようにマスキングテープなどで固定します。表側から16本の脚をはんだ付けします。  
  ![cocot_micro_bg_01_2](/images/bg_01_2.jpg)

  センサーに貼られているテープを剥がし、表面からレンズを付けます。
  ![cocot_micro_bg_01_3](/images/bg_01_3.jpg)


### ボールベース組み立て

  ボールベースにベアリングローラーを固定します。写真の向きに合わせてベアリングローラー、M3ネジ、M3ナットで固定します。ベアリングを支持する3本の柱の両サイドのうち、ベアリングが固定されるのが突起のある面、ナットが触れるのが平坦な面になります。
  ![cocot_micro_bg_02_1](/images/bg_02_1.jpg)

  ![cocot_micro_bg_02_2](/images/bg_02_2.jpg)

  マウスセンサーを固定しレンズを装着したPCBにボールベースを被せます。表面からM2 8mmネジ、裏面からナットで固定します。
  ![cocot_micro_bg_02_3](/images/bg_02_3.jpg)

  ![cocot_micro_bg_02_4](/images/bg_02_4.jpg)


### リングエンコーダ

  リングエンコーダをPCB表面から差し込み、裏面の3か所はんだ付けを行います。  
  ![cocot_micro_bg_03_1](/images/bg_03_1.jpg)

  ![cocot_micro_bg_03_2](/images/bg_03_2.jpg)


### キースイッチ

  8個のキースイッチをPCB表面から差し込み、各スイッチ2か所はんだ付けを行います。スイッチが基板の表面に来るように向きに注意してください。
  ![cocot_micro_bg_04_1](/images/bg_04_1.jpg)

  ![cocot_micro_bg_04_2](/images/bg_04_2.jpg)


### 組み立て

  トレイケース（ボトムプレート）とPCBを3mmネジと4mmスペーサーを用いて固定します。  
  ![cocot_micro_bg_05_1](/images/bg_05_1.jpg)

  ![cocot_micro_bg_05_2](/images/bg_05_2.jpg)

  裏面4か所にゴム脚を貼り付けます。
  ![cocot_micro_bg_05_3](/images/bg_05_3.jpg)

  リングエンコーダ―にボールカバーを取り付けます。緩い場合は内側にテープなどを貼り固定します。
  ![cocot_micro_bg_05_4](/images/bg_05_4.jpg)

  キーキャップをつけます。付属の3Dプリントキーキャップが緩い場合は、ラップなど薄いフィルムを被せて抜けにくくしてください。
  ![cocot_micro_bg_05_5](/images/bg_05_5.jpg)

  ボールを付けて完成です。
  ![cocot_micro_bg_05_6](/images/bg_05_6.jpg)


## ファームウェア

デフォルトのファームが書き込まれた状態でお届けしています。ご自分でファームを書き込む場合、下記手順の通り実行してください。

  - 裏面のBOOTボタンを押しながらRESETボタンを押し、ブートローダーモードに入ります。
  - その状態でRPI-RP2というドライブに[.uf2](https://github.com/aki27kbd/cocot_micro/blob/main/firmware/aki27_cocot_micro_auto_mouse.uf2)ファイルをドラッグ&ドロップすることでファームが書き込まれます。

キーマップは[vial](https://vial.rocks/)から更新可能です。  
トラックボール、LED含めて上記.uf2ファイルで確認いただけます。


![vial](/images/vial.jpg)


ソースコードは[こちら](https://github.com/aki27kbd/vial-qmk/tree/vial/keyboards/aki27/cocot_micro)を参照ください。  
また、VIA用のjsonファイルは[こちら](https://github.com/aki27kbd/cocot_micro/blob/main/firmware/cocot_micro_via.json)を参照ください。


## カスタムキーコード

  トラックボールの操作に関していくつかカスタムキーコードを設定することが可能です。

  Keycode   |Description
  ---------|-----------
  `CPI_SW`  |トラックボールのCPIを変更します。デフォルトのファームウェアでは、押すたびに200→400→800→1600→3200→200…という順番でCPIが変わります。
  `SCRL_SW` |スクロールモードにおけるセンサーの感度を変更します。数値が大きいほどスクロール量が小さくなります。
  `ROT_R15` |マウスセンサーのＹ軸を時計回りに15度回転させます。
  `ROT_L15` |マウスセンサーのＹ軸を反時計回りに15度回転させます。
  `SCRL_MO` |押されている間スクロールモードになります。（デフォルトファームではレイヤー4でのみ有効）
  `SCRL_TO` |押すたびにスクロールモードとマウスモードを切り替えます。（デフォルトファームでは無効）
  `SCRL_IN` |スクロール方向を反転させます。（デフォルトファームでは無効）

  vialでカスタムキーコードを設定する場合はUserタブ下のカスタムキーコードを用いて設定することが可能です。  
  ![CustomKeycode_rev](/images/CustomKeycode.jpg)


## 終わりに
何かトラブルがあれば[Twitterアカウント](https://twitter.com/aki27kbd)までご連絡ください。

また、完成写真をSNSにアップいただけるととても励みになります。（アップするのがはばかられる方はDMで直接送りつけていただいても構いません。）

ハッシュタグは #cocot_micro です。
